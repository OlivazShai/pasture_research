---
title: "Price Data"
author: "Shai Vaz"
date: "May 2024"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, include=FALSE}
# Data Wrangling
library(dplyr)
library(tidyr)
library(stringr)
library(readr)
library(readxl)
library(lubridate)

# Graphics
library(ggplot2)

# Geographic
library(sf)
library(geobr)
```

# CEPEA Data

## Cattle Prices

```{r}
prices_cattle <- read_xlsx(
  path = "../Inputs/prices_cattle.xlsx",
  sheet = "Plan 1",
  col_names = c("date","price_brl","price_usd"),
  skip = 4
  )
```

## Soybeans Prices

```{r}
prices_soybeans <- read_xlsx(
  path = "../Inputs/prices_soybeans.xlsx",
  sheet = "Plan 1",
  col_names = c("date","price_brl","price_usd"),
  skip = 4
  )
```

## Cattle Prices

```{r}
prices_maize <- read_xlsx(
  path = "../Inputs/prices_maize.xlsx",
  sheet = "Plan 1",
  col_names = c("date","price_brl","price_usd"),
  skip = 4
  )
```

## Chicken prices

```{r}
prices_chicken <- read_xlsx(
  path = "../Inputs/prices_chicken.xlsx",
  sheet = "Plan 1",
  col_names = c("date","price_brl","price_usd"),
  skip = 4
  )
```

# Operations or whatever

## Cattle prices for 2017 census

Reference period for the 2017 census is *Oct 01 2016* through *Sep 30 2017*. Here I'll extract the average CEPEA price for this period.

```{r}
cattle_price_2017_cepea <- prices_cattle %>% 
  mutate(
    date = as_date(date, format = "%d/%m/%Y")
  ) %>% 
  filter(
    date > "2016-10-01" & date < "2017-09-30"
  ) %>% 
  summarise(
    mean_price = mean(price_brl)
  ) %>% 
  as.numeric()
```

## Yearly prices

## Join Dataframes
